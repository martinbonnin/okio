


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A modern I/O library for Android, Kotlin, and Java.">
      
      
      
        <meta name="author" content="Square, Inc.">
      
      <link rel="shortcut icon" href="images/icon-square.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.7">
    
    
      
        <title>Okio</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.b8ac9624.min.css">
      
        <link rel="stylesheet" href="assets/stylesheets/palette.28f3ef9a.min.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="css/app.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent="white">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#okio" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="." title="Okio" class="md-header-nav__button md-logo" aria-label="Okio">
      
  <img src="images/icon-square.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Okio
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Overview
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/square/okio/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Okio
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Okio" class="md-nav__button md-logo" aria-label="Okio">
      
  <img src="images/icon-square.png" alt="logo">

    </a>
    Okio
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/square/okio/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Okio
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Overview
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="." title="Overview" class="md-nav__link md-nav__link--active">
      Overview
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bytestrings-and-buffers" class="md-nav__link">
    ByteStrings and Buffers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sources-and-sinks" class="md-nav__link">
    Sources and Sinks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#presentations" class="md-nav__link">
    Presentations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipes" class="md-nav__link">
    Recipes
  </a>
  
    <nav class="md-nav" aria-label="Recipes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#read-a-text-file-line-by-line-javakotlin" class="md-nav__link">
    Read a text file line-by-line (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-a-text-file-javakotlin" class="md-nav__link">
    Write a text file (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utf-8-javakotlin" class="md-nav__link">
    UTF-8 (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#golden-values-javakotlin" class="md-nav__link">
    Golden Values (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-a-binary-file-javakotlin" class="md-nav__link">
    Write a binary file (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#communicate-on-a-socket-javakotlin" class="md-nav__link">
    Communicate on a Socket (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashing-javakotlin" class="md-nav__link">
    Hashing (Java/Kotlin)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#releases" class="md-nav__link">
    Releases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#r8-proguard" class="md-nav__link">
    R8 / ProGuard
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://stackoverflow.com/questions/tagged/okio?sort=active" title="Stack Overflow ⏏" class="md-nav__link">
      Stack Overflow ⏏
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="2.x/okio/okio/" title="2.x API" class="md-nav__link">
      2.x API
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://square.github.io/okio/1.x/okio/" title="1.x API ⏏" class="md-nav__link">
      1.x API ⏏
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="changelog/" title="Change Log" class="md-nav__link">
      Change Log
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="code_of_conduct/" title="Code of Conduct" class="md-nav__link">
      Code of Conduct
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bytestrings-and-buffers" class="md-nav__link">
    ByteStrings and Buffers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sources-and-sinks" class="md-nav__link">
    Sources and Sinks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#presentations" class="md-nav__link">
    Presentations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipes" class="md-nav__link">
    Recipes
  </a>
  
    <nav class="md-nav" aria-label="Recipes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#read-a-text-file-line-by-line-javakotlin" class="md-nav__link">
    Read a text file line-by-line (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-a-text-file-javakotlin" class="md-nav__link">
    Write a text file (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utf-8-javakotlin" class="md-nav__link">
    UTF-8 (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#golden-values-javakotlin" class="md-nav__link">
    Golden Values (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-a-binary-file-javakotlin" class="md-nav__link">
    Write a binary file (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#communicate-on-a-socket-javakotlin" class="md-nav__link">
    Communicate on a Socket (Java/Kotlin)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashing-javakotlin" class="md-nav__link">
    Hashing (Java/Kotlin)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#releases" class="md-nav__link">
    Releases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#r8-proguard" class="md-nav__link">
    R8 / ProGuard
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/square/okio/edit/master/docs/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="okio">Okio<a class="headerlink" href="#okio" title="Permanent link">&para;</a></h1>
<p>Okio is a library that complements <code>java.io</code> and <code>java.nio</code> to make it much
easier to access, store, and process your data. It started as a component of
<a href="https://github.com/square/okhttp">OkHttp</a>, the capable HTTP client included in Android. It&rsquo;s well-exercised
and ready to solve new problems.</p>
<h2 id="bytestrings-and-buffers">ByteStrings and Buffers<a class="headerlink" href="#bytestrings-and-buffers" title="Permanent link">&para;</a></h2>
<p>Okio is built around two types that pack a lot of capability into a
straightforward API:</p>
<ul>
<li>
<p><a href="https://square.github.io/okio/2.x/okio/okio/-byte-string/index.html"><strong>ByteString</strong></a> is an immutable sequence of bytes. For character data, <code>String</code>
   is fundamental. <code>ByteString</code> is String&rsquo;s long-lost brother, making it easy to
   treat binary data as a value. This class is ergonomic: it knows how to encode
   and decode itself as hex, base64, and UTF-8.</p>
</li>
<li>
<p><a href="https://square.github.io/okio/2.x/okio/okio/-buffer/index.html"><strong>Buffer</strong></a> is a mutable sequence of bytes. Like <code>ArrayList</code>, you don&rsquo;t need
   to size your buffer in advance. You read and write buffers as a queue: write
   data to the end and read it from the front. There&rsquo;s no obligation to manage
   positions, limits, or capacities.</p>
</li>
</ul>
<p>Internally, <code>ByteString</code> and <code>Buffer</code> do some clever things to save CPU and
memory. If you encode a UTF-8 string as a <code>ByteString</code>, it caches a reference to
that string so that if you decode it later, there&rsquo;s no work to do.</p>
<p><code>Buffer</code> is implemented as a linked list of segments. When you move data from
one buffer to another, it <em>reassigns ownership</em> of the segments rather than
copying the data across. This approach is particularly helpful for multithreaded
programs: a thread that talks to the network can exchange data with a worker
thread without any copying or ceremony.</p>
<h2 id="sources-and-sinks">Sources and Sinks<a class="headerlink" href="#sources-and-sinks" title="Permanent link">&para;</a></h2>
<p>An elegant part of the <code>java.io</code> design is how streams can be layered for
transformations like encryption and compression. Okio includes its own stream
types called <a href="https://square.github.io/okio/2.x/okio/okio/-source/index.html"><code>Source</code></a> and <a href="https://square.github.io/okio/2.x/okio/okio/-sink/index.html"><code>Sink</code></a> that work like <code>InputStream</code> and
<code>OutputStream</code>, but with some key differences:</p>
<ul>
<li>
<p><strong>Timeouts.</strong> The streams provide access to the timeouts of the underlying
   I/O mechanism. Unlike the <code>java.io</code> socket streams, both <code>read()</code> and
   <code>write()</code> calls honor timeouts.</p>
</li>
<li>
<p><strong>Easy to implement.</strong> <code>Source</code> declares three methods: <code>read()</code>, <code>close()</code>,
   and <code>timeout()</code>. There are no hazards like <code>available()</code> or single-byte reads
   that cause correctness and performance surprises.</p>
</li>
<li>
<p><strong>Easy to use.</strong> Although <em>implementations</em> of <code>Source</code> and <code>Sink</code> have only
   three methods to write, <em>callers</em> are given a rich API with the
   <a href="https://square.github.io/okio/2.x/okio/okio/-buffered-source/index.html"><code>BufferedSource</code></a> and <a href="https://square.github.io/okio/2.x/okio/okio/-buffered-sink/index.html"><code>BufferedSink</code></a> interfaces. These interfaces give you
   everything you need in one place.</p>
</li>
<li>
<p><strong>No artificial distinction between byte streams and char streams.</strong> It&rsquo;s all
   data. Read and write it as bytes, UTF-8 strings, big-endian 32-bit integers,
   little-endian shorts; whatever you want. No more <code>InputStreamReader</code>!</p>
</li>
<li>
<p><strong>Easy to test.</strong> The <code>Buffer</code> class implements both <code>BufferedSource</code> and
   <code>BufferedSink</code> so your test code is simple and clear.</p>
</li>
</ul>
<p>Sources and sinks interoperate with <code>InputStream</code> and <code>OutputStream</code>. You can
view any <code>Source</code> as an <code>InputStream</code>, and you can view any <code>InputStream</code> as a
<code>Source</code>. Similarly for <code>Sink</code> and <code>OutputStream</code>.</p>
<h2 id="presentations">Presentations<a class="headerlink" href="#presentations" title="Permanent link">&para;</a></h2>
<p><a href="https://www.youtube.com/watch?v=WvyScM_S88c">A Few “Ok” Libraries</a> (<a href="https://speakerdeck.com/jakewharton/a-few-ok-libraries-droidcon-mtl-2015">slides</a>): An introduction to Okio
and three libraries written with it.</p>
<p><a href="https://www.youtube.com/watch?v=T_p22jMZSrk">Decoding the Secrets of Binary Data</a> (<a href="https://speakerdeck.com/swankjesse/decoding-the-secrets-of-binary-data-droidcon-nyc-2016">slides</a>): How data encoding
works and how Okio does it.</p>
<p><a href="https://www.youtube.com/watch?v=Q8B4eDirgk0">Ok Multiplatform!</a> (<a href="https://speakerdeck.com/swankjesse/ok-multiplatform">slides</a>): How we changed
Okio’s implementation language from Java to Kotlin.</p>
<h2 id="recipes">Recipes<a class="headerlink" href="#recipes" title="Permanent link">&para;</a></h2>
<p>We&rsquo;ve written some recipes that demonstrate how to solve common problems with
Okio. Read through them to learn about how everything works together.
Cut-and-paste these examples freely; that&rsquo;s what they&rsquo;re for.</p>
<h3 id="read-a-text-file-line-by-line-javakotlin">Read a text file line-by-line (<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/java/okio/samples/ReadFileLineByLine.java">Java</a>/<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/kotlin/okio/samples/ReadFileLineByLine.kt">Kotlin</a>)<a class="headerlink" href="#read-a-text-file-line-by-line-javakotlin" title="Permanent link">&para;</a></h3>
<p>Use <code>Okio.source(File)</code> to open a source stream to read a file. The returned
<code>Source</code> interface is very small and has limited uses. Instead we wrap the
source with a buffer. This has two benefits:</p>
<ul>
<li>
<p><strong>It makes the API more powerful.</strong> Instead of the basic methods offered by
   <code>Source</code>, <code>BufferedSource</code> has dozens of methods to address most common
   problems concisely.</p>
</li>
<li>
<p><strong>It makes your program run faster.</strong> Buffering allows Okio to get more done
   with fewer I/O operations.</p>
</li>
</ul>
<p>Each <code>Source</code> that is opened needs to be closed. The code that opens the stream
is responsible for making sure it is closed. Here we use Java&rsquo;s <code>try</code> blocks to
close our sources automatically.</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">readLines</span><span class="p">(</span><span class="n">File</span> <span class="n">file</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">(</span><span class="n">Source</span> <span class="n">fileSource</span> <span class="o">=</span> <span class="n">Okio</span><span class="p">.</span><span class="na">source</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
       <span class="n">BufferedSource</span> <span class="n">bufferedSource</span> <span class="o">=</span> <span class="n">Okio</span><span class="p">.</span><span class="na">buffer</span><span class="p">(</span><span class="n">fileSource</span><span class="p">))</span> <span class="p">{</span>

    <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="n">bufferedSource</span><span class="p">.</span><span class="na">readUtf8Line</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">line</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;square&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>

  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Below is the same example written in Kotlin. Note that static <code>Okio</code> methods become extension 
functions (<code>Okio.source(file)</code> =&gt; <code>file.source()</code>), and <code>use</code> is used to automatically close the
streams:</p>
<div class="highlight"><pre><span></span><code><span class="n">@Throws</span><span class="p">(</span><span class="n">IOException</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="k">fun</span> <span class="nf">readLines</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">File</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">file</span><span class="p">.</span><span class="n">source</span><span class="p">().</span><span class="n">use</span> <span class="p">{</span> <span class="n">fileSource</span> <span class="p">-&gt;</span>
    <span class="n">fileSource</span><span class="p">.</span><span class="n">buffer</span><span class="p">().</span><span class="n">use</span> <span class="p">{</span> <span class="n">bufferedFileSource</span> <span class="p">-&gt;</span>
      <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">val</span> <span class="py">line</span> <span class="p">=</span> <span class="n">bufferedFileSource</span><span class="p">.</span><span class="n">readUtf8Line</span><span class="p">()</span> <span class="o">?:</span> <span class="k">break</span>
        <span class="k">if</span> <span class="p">(</span><span class="s">&quot;square&quot;</span> <span class="k">in</span> <span class="n">line</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">println</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>The <code>readUtf8Line()</code> API reads all of the data until the next line delimiter –
either <code>\n</code>, <code>\r\n</code>, or the end of the file. It returns that data as a string,
omitting the delimiter at the end. When it encounters empty lines the method
will return an empty string. If there isn’t any more data to read it will
return null.</p>
<p>The above program can be written more compactly by inlining the <code>fileSource</code>
variable and by using a fancy <code>for</code> loop instead of a <code>while</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">readLines</span><span class="p">(</span><span class="n">File</span> <span class="n">file</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">(</span><span class="n">BufferedSource</span> <span class="n">source</span> <span class="o">=</span> <span class="n">Okio</span><span class="p">.</span><span class="na">buffer</span><span class="p">(</span><span class="n">Okio</span><span class="p">.</span><span class="na">source</span><span class="p">(</span><span class="n">file</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">String</span> <span class="n">line</span><span class="p">;</span> <span class="p">(</span><span class="n">line</span> <span class="o">=</span> <span class="n">source</span><span class="p">.</span><span class="na">readUtf8Line</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;square&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>In Kotlin, we can wrap invocations of <code>source.readUtf8Line()</code> into the <code>generateSequence</code> builder to 
create a sequence of lines that will end once null is returned. Plus, transforming streams is easy 
thanks to the extension functions:</p>
<div class="highlight"><pre><span></span><code><span class="n">@Throws</span><span class="p">(</span><span class="n">IOException</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="k">fun</span> <span class="nf">readLines</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">File</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">file</span><span class="p">.</span><span class="n">source</span><span class="p">().</span><span class="n">buffer</span><span class="p">().</span><span class="n">use</span> <span class="p">{</span> <span class="n">source</span> <span class="p">-&gt;</span>
    <span class="n">generateSequence</span> <span class="p">{</span> <span class="n">source</span><span class="p">.</span><span class="n">readUtf8Line</span><span class="p">()</span> <span class="p">}</span>
      <span class="p">.</span><span class="n">filter</span> <span class="p">{</span> <span class="n">line</span> <span class="p">-&gt;</span> <span class="s">&quot;square&quot;</span> <span class="k">in</span> <span class="n">line</span> <span class="p">}</span>
      <span class="p">.</span><span class="n">forEach</span><span class="p">(</span><span class="o">::</span><span class="n">println</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>The <code>readUtf8Line()</code> method is suitable for parsing most files. For certain
use-cases you may also consider <code>readUtf8LineStrict()</code>. It is similar but it
requires that each line is terminated by <code>\n</code> or <code>\r\n</code>. If it encounters the
end of the file before that it will throw an <code>EOFException</code>. The strict variant
also permits a byte limit to defend against malformed input.</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">readLines</span><span class="p">(</span><span class="n">File</span> <span class="n">file</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">(</span><span class="n">BufferedSource</span> <span class="n">source</span> <span class="o">=</span> <span class="n">Okio</span><span class="p">.</span><span class="na">buffer</span><span class="p">(</span><span class="n">Okio</span><span class="p">.</span><span class="na">source</span><span class="p">(</span><span class="n">file</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">source</span><span class="p">.</span><span class="na">exhausted</span><span class="p">())</span> <span class="p">{</span>
      <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="n">source</span><span class="p">.</span><span class="na">readUtf8LineStrict</span><span class="p">(</span><span class="mi">1024L</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;square&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Here&rsquo;s a similar example written in Kotlin:</p>
<div class="highlight"><pre><span></span><code><span class="n">@Throws</span><span class="p">(</span><span class="n">IOException</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="k">fun</span> <span class="nf">readLines</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">File</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">file</span><span class="p">.</span><span class="n">source</span><span class="p">().</span><span class="n">buffer</span><span class="p">().</span><span class="n">use</span> <span class="p">{</span> <span class="n">source</span> <span class="p">-&gt;</span>
    <span class="k">while</span> <span class="p">(!</span><span class="n">source</span><span class="p">.</span><span class="n">exhausted</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">val</span> <span class="py">line</span> <span class="p">=</span> <span class="n">source</span><span class="p">.</span><span class="n">readUtf8LineStrict</span><span class="p">(</span><span class="m">1024</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="s">&quot;square&quot;</span> <span class="k">in</span> <span class="n">line</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">println</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="write-a-text-file-javakotlin">Write a text file (<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/java/okio/samples/WriteFile.java">Java</a>/<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/kotlin/okio/samples/WriteFile.kt">Kotlin</a>)<a class="headerlink" href="#write-a-text-file-javakotlin" title="Permanent link">&para;</a></h3>
<p>Above we used a <code>Source</code> and a <code>BufferedSource</code> to read a file. To write, we use
a <code>Sink</code> and a <code>BufferedSink</code>. The advantages of buffering are the same: a more
capable API and better performance.</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">writeEnv</span><span class="p">(</span><span class="n">File</span> <span class="n">file</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">(</span><span class="n">Sink</span> <span class="n">fileSink</span> <span class="o">=</span> <span class="n">Okio</span><span class="p">.</span><span class="na">sink</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
       <span class="n">BufferedSink</span> <span class="n">bufferedSink</span> <span class="o">=</span> <span class="n">Okio</span><span class="p">.</span><span class="na">buffer</span><span class="p">(</span><span class="n">fileSink</span><span class="p">))</span> <span class="p">{</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="p">:</span> <span class="n">System</span><span class="p">.</span><span class="na">getenv</span><span class="p">().</span><span class="na">entrySet</span><span class="p">())</span> <span class="p">{</span>
      <span class="n">bufferedSink</span><span class="p">.</span><span class="na">writeUtf8</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">());</span>
      <span class="n">bufferedSink</span><span class="p">.</span><span class="na">writeUtf8</span><span class="p">(</span><span class="s">&quot;=&quot;</span><span class="p">);</span>
      <span class="n">bufferedSink</span><span class="p">.</span><span class="na">writeUtf8</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span>
      <span class="n">bufferedSink</span><span class="p">.</span><span class="na">writeUtf8</span><span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>There isn’t an API to write a line of input; instead we manually insert our own
newline character. Most programs should hardcode <code>"\n"</code> as the newline
character. In rare situations you may use <code>System.lineSeparator()</code> instead of
<code>"\n"</code>: it returns <code>"\r\n"</code> on Windows and <code>"\n"</code> everywhere else.</p>
<p>We can write the above program more compactly by inlining the <code>fileSink</code>
variable and by taking advantage of method chaining:</p>
<p>```Java tab=
public void writeEnv(File file) throws IOException {
  try (BufferedSink sink = Okio.buffer(Okio.sink(file))) {
    for (Map.Entry<String, String> entry : System.getenv().entrySet()) {
      sink.writeUtf8(entry.getKey())
          .writeUtf8(&ldquo;=&rdquo;)
          .writeUtf8(entry.getValue())
          .writeUtf8(&ldquo;\n&rdquo;);
    }
  }
}
<div class="highlight"><pre><span></span><code>```Kotlin tab=
@Throws(IOException::class)
fun writeEnv(file: File) {
  file.sink().buffer().use { sink -&gt;
    for ((key, value) in System.getenv()) {
      sink.writeUtf8(key)
      sink.writeUtf8(&quot;=&quot;)
      sink.writeUtf8(value)
      sink.writeUtf8(&quot;\n&quot;)
    }
  }
}
</code></pre></div></p>
<p>In the above code we make four calls to <code>writeUtf8()</code>. Making four calls is
more efficient than the code below because the VM doesn’t have to create and
garbage collect a temporary string.</p>
<div class="highlight"><pre><span></span><code><span class="n">sink</span><span class="p">.</span><span class="na">writeUtf8</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;=&quot;</span> <span class="o">+</span> <span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;\n&quot;</span><span class="p">);</span> <span class="c1">// Slower!</span>
</code></pre></div>

<h3 id="utf-8-javakotlin">UTF-8 (<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/java/okio/samples/ExploreCharsets.java">Java</a>/<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/kotlin/okio/samples/ExploreCharsets.kt">Kotlin</a>)<a class="headerlink" href="#utf-8-javakotlin" title="Permanent link">&para;</a></h3>
<p>In the above APIs you can see that Okio really likes UTF-8. Early computer
systems suffered many incompatible character encodings: ISO-8859-1, ShiftJIS,
ASCII, EBCDIC, etc. Writing software to support multiple character sets was
awful and we didn’t even have emoji! Today we&rsquo;re lucky that the world has
standardized on UTF-8 everywhere, with some rare uses of other charsets in
legacy systems.</p>
<p>If you need another character set, <code>readString()</code> and <code>writeString()</code> are there
for you. These methods require that you specify a character set. Otherwise you
may accidentally create data that is only readable by the local computer. Most
programs should use the UTF-8 methods only.</p>
<p>When encoding strings you need to be mindful of the different ways that strings
are represented and encoded. When a glyph has an accent or another adornment
it may be represented as a single complex code point (<code>é</code>) or as a simple code
point (<code>e</code>) followed by its modifiers (<code>´</code>). When the entire glyph is a single
code point that’s called <a href="https://docs.oracle.com/javase/7/docs/api/java/text/Normalizer.Form.html#NFC">NFC</a>; when it’s multiple it’s <a href="https://docs.oracle.com/javase/7/docs/api/java/text/Normalizer.Form.html#NFD">NFD</a>.</p>
<p>Though we use UTF-8 whenever we read or write strings in I/O, when they are in
memory Java Strings use an obsolete character encoding called UTF-16. It is a
bad encoding because it uses a 16-bit <code>char</code> for most characters, but some don’t
fit. In particular, most emoji use two Java chars. This is problematic because
<code>String.length()</code> returns a surprising result: the number of UTF-16 chars and
not the natural number of glyphs.</p>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">Café 🍩</th>
<th align="left">Café 🍩</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">Form</td>
<td align="left"><a href="https://docs.oracle.com/javase/7/docs/api/java/text/Normalizer.Form.html#NFC">NFC</a></td>
<td align="left"><a href="https://docs.oracle.com/javase/7/docs/api/java/text/Normalizer.Form.html#NFD">NFD</a></td>
</tr>
<tr>
<td align="right">Code Points</td>
<td align="left"><code>c  a  f  é    ␣   🍩</code></td>
<td align="left"><code>c  a  f  e  ´    ␣   🍩</code></td>
</tr>
<tr>
<td align="right">UTF-8 bytes</td>
<td align="left"><code>43 61 66 c3a9 20 f09f8da9</code></td>
<td align="left"><code>43 61 66 65 cc81 20 f09f8da9</code></td>
</tr>
<tr>
<td align="right">String.codePointCount</td>
<td align="left">6</td>
<td align="left">7</td>
</tr>
<tr>
<td align="right">String.length</td>
<td align="left">7</td>
<td align="left">8</td>
</tr>
<tr>
<td align="right">Utf8.size</td>
<td align="left">10</td>
<td align="left">11</td>
</tr>
</tbody>
</table>
<p>For the most part Okio lets you ignore these problems and focus on your data.
But when you need them, there are convenient APIs for dealing with low-level
UTF-8 strings.</p>
<p>Use <code>Utf8.size()</code> to count the number of bytes required to encode a string as
UTF-8 without actually encoding it. This is handy in length-prefixed encodings
like protocol buffers.</p>
<p>Use <code>BufferedSource.readUtf8CodePoint()</code> to read a single variable-length code
point, and <code>BufferedSink.writeUtf8CodePoint()</code> to write one.</p>
<h3 id="golden-values-javakotlin">Golden Values (<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/java/okio/samples/GoldenValue.java">Java</a>/<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/kotlin/okio/samples/GoldenValue.kt">Kotlin</a>)<a class="headerlink" href="#golden-values-javakotlin" title="Permanent link">&para;</a></h3>
<p>Okio likes testing. The library itself is heavily tested, and it has features
that are often helpful when testing application code. One pattern we’ve found to
be quite useful is “golden value” testing. The goal of such tests is to confirm
that data encoded with earlier versions of a program can safely be decoded by
the current program.</p>
<p>We’ll illustrate this by encoding a value using Java Serialization. Though we
must disclaim that Java Serialization is an awful encoding system and most
programs should prefer other formats like JSON or protobuf! In any case, here’s
a method that takes an object, serializes it, and returns the result as a
<code>ByteString</code>:</p>
<p>```Java tab=
private ByteString serialize(Object o) throws IOException {
  Buffer buffer = new Buffer();
  try (ObjectOutputStream objectOut = new ObjectOutputStream(buffer.outputStream())) {
    objectOut.writeObject(o);
  }
  return buffer.readByteString();
}
<div class="highlight"><pre><span></span><code>```Kotlin tab=
@Throws(IOException::class)
private fun serialize(o: Any?): ByteString {
  val buffer = Buffer()
  ObjectOutputStream(buffer.outputStream()).use { objectOut -&gt;
    objectOut.writeObject(o)
  }
  return buffer.readByteString()
}
</code></pre></div></p>
<p>There’s a lot going on here.</p>
<ol>
<li>
<p>We create a buffer as a holding space for our serialized data. It’s a convenient
   replacement for <code>ByteArrayOutputStream</code>.</p>
</li>
<li>
<p>We ask the buffer for its output stream. Writes to a buffer or its output stream
   always append data to the end of the buffer.</p>
</li>
<li>
<p>We create an <code>ObjectOutputStream</code> (the encoding API for Java serialization) and
   write our object. The try block takes care of closing the stream for us. Note
   that closing a buffer has no effect.</p>
</li>
<li>
<p>Finally we read a byte string from the buffer. The <code>readByteString()</code> method
   allows us to specify how many bytes to read; here we don’t specify a count in
   order to read the entire thing. Reads from a buffer always consume data from
   the front of the buffer.</p>
</li>
</ol>
<p>With our <code>serialize()</code> method handy we are ready to compute and print a golden
value.</p>
<p>```Java tab=
Point point = new Point(8.0, 15.0);
ByteString pointBytes = serialize(point);
System.out.println(pointBytes.base64());
<div class="highlight"><pre><span></span><code>```Kotlin tab=
val point = Point(8.0, 15.0)
val pointBytes = serialize(point)
println(pointBytes.base64())
</code></pre></div></p>
<p>We print the <code>ByteString</code> as <a href="https://tools.ietf.org/html/rfc4648#section-4">base64</a> because it’s a compact format
that’s suitable for embedding in a test case. The program prints this:</p>
<p>```Java tab=
rO0ABXNyAB5va2lvLnNhbXBsZXMuR29sZGVuVmFsdWUkUG9pbnTdUW8rMji1IwIAAkQAAXhEAAF5eHBAIAAAAAAAAEAuAAAAAAAA
<div class="highlight"><pre><span></span><code>```Kotlin tab=
rO0ABXNyACRva2lvLnNhbXBsZXMuS290bGluR29sZGVuVmFsdWUkUG9pbnRF9yaY7cJ9EwIAAkQAAXhEAAF5eHBAIAAAAAAAAEAuAAAAAAAA
</code></pre></div></p>
<p>That’s our golden value! We can embed it in our test case using base64 again
to convert it back into a <code>ByteString</code>:</p>
<p>```Java tab=
ByteString goldenBytes = ByteString.decodeBase64(&ldquo;rO0ABXNyAB5va2lvLnNhbXBsZ&rdquo;
    + &ldquo;XMuR29sZGVuVmFsdWUkUG9pbnTdUW8rMji1IwIAAkQAAXhEAAF5eHBAIAAAAAAAAEAuA&rdquo;
    + &ldquo;AAAAAAA&rdquo;);
<div class="highlight"><pre><span></span><code>```Kotlin tab=
val goldenBytes = (&quot;rO0ABXNyACRva2lvLnNhbXBsZXMuS290bGluR29sZGVuVmFsdWUkUG9pbnRF9yaY7cJ9EwIAA&quot; +
  &quot;kQAAXhEAAF5eHBAIAAAAAAAAEAuAAAAAAAA&quot;).decodeBase64()
</code></pre></div></p>
<p>The next step is to deserialize the <code>ByteString</code> back into our value class. This
method reverses the <code>serialize()</code> method above: we append a byte string to a
buffer then consume it using an <code>ObjectInputStream</code>:</p>
<p>```Java tab=
private Object deserialize(ByteString byteString) throws IOException, ClassNotFoundException {
  Buffer buffer = new Buffer();
  buffer.write(byteString);
  try (ObjectInputStream objectIn = new ObjectInputStream(buffer.inputStream())) {
    return objectIn.readObject();
  }
}
<div class="highlight"><pre><span></span><code>```Kotlin tab=
@Throws(IOException::class, ClassNotFoundException::class)
private fun deserialize(byteString: ByteString): Any? {
  val buffer = Buffer()
  buffer.write(byteString)
  ObjectInputStream(buffer.inputStream()).use { objectIn -&gt;
    return objectIn.readObject()
  }
}
</code></pre></div></p>
<p>Now we can test the decoder against the golden value:</p>
<p>```Java tab=
ByteString goldenBytes = ByteString.decodeBase64(&ldquo;rO0ABXNyAB5va2lvLnNhbXBsZ&rdquo;
    + &ldquo;XMuR29sZGVuVmFsdWUkUG9pbnTdUW8rMji1IwIAAkQAAXhEAAF5eHBAIAAAAAAAAEAuA&rdquo;
    + &ldquo;AAAAAAA&rdquo;);
Point decoded = (Point) deserialize(goldenBytes);
assertEquals(new Point(8.0, 15.0), decoded);
<div class="highlight"><pre><span></span><code>```Kotlin tab=
val goldenBytes = (&quot;rO0ABXNyACRva2lvLnNhbXBsZXMuS290bGluR29sZGVuVmFsdWUkUG9pbnRF9yaY7cJ9EwIAA&quot; +
  &quot;kQAAXhEAAF5eHBAIAAAAAAAAEAuAAAAAAAA&quot;).decodeBase64()!!
val decoded = deserialize(goldenBytes) as Point
assertEquals(point, decoded)
</code></pre></div></p>
<p>With this test we can change the serialization of the <code>Point</code> class without
breaking compatibility.</p>
<h3 id="write-a-binary-file-javakotlin">Write a binary file (<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/java/okio/samples/BitmapEncoder.java">Java</a>/<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/kotlin/okio/samples/BitmapEncoder.kt">Kotlin</a>)<a class="headerlink" href="#write-a-binary-file-javakotlin" title="Permanent link">&para;</a></h3>
<p>Encoding a binary file is not unlike encoding a text file. Okio uses the same
<code>BufferedSink</code> and <code>BufferedSource</code> bytes for both. This is handy for binary
formats that include both byte and character data.</p>
<p>Writing binary data is more hazardous than text because if you make a mistake it
is often quite difficult to diagnose. Avoid such mistakes by being careful
around these traps:</p>
<ul>
<li>
<p><strong>The width of each field.</strong> This is the number of bytes used. Okio doesn&rsquo;t
   include a mechanism to emit partial bytes. If you need that, you’ll need to
   do your own bit shifting and masking before writing.</p>
</li>
<li>
<p><strong>The endianness of each field.</strong> All fields that have more than one byte
   have <em>endianness</em>: whether the bytes are ordered most-significant to least
   (big endian) or least-significant to most (little endian). Okio uses the <code>Le</code>
   suffix for little-endian methods; methods without a suffix are big-endian.</p>
</li>
<li>
<p><strong>Signed vs. Unsigned.</strong> Java doesn’t have unsigned primitive types (except
   for <code>char</code>!) so coping with this is often something that happens at the
   application layer. To make this a little easier Okio accepts <code>int</code> types for
   <code>writeByte()</code> and <code>writeShort()</code>. You can pass an “unsigned” byte like 255
   and Okio will do the right thing.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Method</th>
<th align="right">Width</th>
<th align="left">Endianness</th>
<th align="right">Value</th>
<th align="left">Encoded Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">writeByte</td>
<td align="right">1</td>
<td align="left"></td>
<td align="right">3</td>
<td align="left"><code>03</code></td>
</tr>
<tr>
<td align="left">writeShort</td>
<td align="right">2</td>
<td align="left">big</td>
<td align="right">3</td>
<td align="left"><code>00 03</code></td>
</tr>
<tr>
<td align="left">writeInt</td>
<td align="right">4</td>
<td align="left">big</td>
<td align="right">3</td>
<td align="left"><code>00 00 00 03</code></td>
</tr>
<tr>
<td align="left">writeLong</td>
<td align="right">8</td>
<td align="left">big</td>
<td align="right">3</td>
<td align="left"><code>00 00 00 00 00 00 00 03</code></td>
</tr>
<tr>
<td align="left">writeShortLe</td>
<td align="right">2</td>
<td align="left">little</td>
<td align="right">3</td>
<td align="left"><code>03 00</code></td>
</tr>
<tr>
<td align="left">writeIntLe</td>
<td align="right">4</td>
<td align="left">little</td>
<td align="right">3</td>
<td align="left"><code>03 00 00 00</code></td>
</tr>
<tr>
<td align="left">writeLongLe</td>
<td align="right">8</td>
<td align="left">little</td>
<td align="right">3</td>
<td align="left"><code>03 00 00 00 00 00 00 00</code></td>
</tr>
<tr>
<td align="left">writeByte</td>
<td align="right">1</td>
<td align="left"></td>
<td align="right">Byte.MAX_VALUE</td>
<td align="left"><code>7f</code></td>
</tr>
<tr>
<td align="left">writeShort</td>
<td align="right">2</td>
<td align="left">big</td>
<td align="right">Short.MAX_VALUE</td>
<td align="left"><code>7f ff</code></td>
</tr>
<tr>
<td align="left">writeInt</td>
<td align="right">4</td>
<td align="left">big</td>
<td align="right">Int.MAX_VALUE</td>
<td align="left"><code>7f ff ff ff</code></td>
</tr>
<tr>
<td align="left">writeLong</td>
<td align="right">8</td>
<td align="left">big</td>
<td align="right">Long.MAX_VALUE</td>
<td align="left"><code>7f ff ff ff ff ff ff ff</code></td>
</tr>
<tr>
<td align="left">writeShortLe</td>
<td align="right">2</td>
<td align="left">little</td>
<td align="right">Short.MAX_VALUE</td>
<td align="left"><code>ff 7f</code></td>
</tr>
<tr>
<td align="left">writeIntLe</td>
<td align="right">4</td>
<td align="left">little</td>
<td align="right">Int.MAX_VALUE</td>
<td align="left"><code>ff ff ff 7f</code></td>
</tr>
<tr>
<td align="left">writeLongLe</td>
<td align="right">8</td>
<td align="left">little</td>
<td align="right">Long.MAX_VALUE</td>
<td align="left"><code>ff ff ff ff ff ff ff 7f</code></td>
</tr>
</tbody>
</table>
<p>This code encodes a bitmap following the <a href="https://en.wikipedia.org/wiki/BMP_file_format">BMP file format</a>.</p>
<p>```Java tab=
void encode(Bitmap bitmap, BufferedSink sink) throws IOException {
  int height = bitmap.height();
  int width = bitmap.width();</p>
<p>int bytesPerPixel = 3;
  int rowByteCountWithoutPadding = (bytesPerPixel * width);
  int rowByteCount = ((rowByteCountWithoutPadding + 3) / 4) * 4;
  int pixelDataSize = rowByteCount * height;
  int bmpHeaderSize = 14;
  int dibHeaderSize = 40;</p>
<p>// BMP Header
  sink.writeUtf8(&ldquo;BM&rdquo;); // ID.
  sink.writeIntLe(bmpHeaderSize + dibHeaderSize + pixelDataSize); // File size.
  sink.writeShortLe(0); // Unused.
  sink.writeShortLe(0); // Unused.
  sink.writeIntLe(bmpHeaderSize + dibHeaderSize); // Offset of pixel data.</p>
<p>// DIB Header
  sink.writeIntLe(dibHeaderSize);
  sink.writeIntLe(width);
  sink.writeIntLe(height);
  sink.writeShortLe(1);  // Color plane count.
  sink.writeShortLe(bytesPerPixel * Byte.SIZE);
  sink.writeIntLe(0);    // No compression.
  sink.writeIntLe(16);   // Size of bitmap data including padding.
  sink.writeIntLe(2835); // Horizontal print resolution in pixels/meter. (72 dpi).
  sink.writeIntLe(2835); // Vertical print resolution in pixels/meter. (72 dpi).
  sink.writeIntLe(0);    // Palette color count.
  sink.writeIntLe(0);    // 0 important colors.</p>
<p>// Pixel data.
  for (int y = height - 1; y &gt;= 0; y&ndash;) {
    for (int x = 0; x &lt; width; x++) {
      sink.writeByte(bitmap.blue(x, y));
      sink.writeByte(bitmap.green(x, y));
      sink.writeByte(bitmap.red(x, y));
    }</p>
<div class="codehilite"><pre><span></span><code>// Padding for 4-byte alignment.
for (int p = rowByteCountWithoutPadding; p &lt; rowByteCount; p++) {
  sink.writeByte(0);
}
</code></pre></div>


<p>}
}
<code></code>Kotlin tab=
@Throws(IOException::class)
fun encode(bitmap: Bitmap, sink: BufferedSink) {
  val height = bitmap.height
  val width = bitmap.width
  val bytesPerPixel = 3
  val rowByteCountWithoutPadding = bytesPerPixel * width
  val rowByteCount = (rowByteCountWithoutPadding + 3) / 4 * 4
  val pixelDataSize = rowByteCount * height
  val bmpHeaderSize = 14
  val dibHeaderSize = 40

  // BMP Header
  sink.writeUtf8(&ldquo;BM&rdquo;) // ID.
  sink.writeIntLe(bmpHeaderSize + dibHeaderSize + pixelDataSize) // File size.
  sink.writeShortLe(0) // Unused.
  sink.writeShortLe(0) // Unused.
  sink.writeIntLe(bmpHeaderSize + dibHeaderSize) // Offset of pixel data.

  // DIB Header
  sink.writeIntLe(dibHeaderSize)
  sink.writeIntLe(width)
  sink.writeIntLe(height)
  sink.writeShortLe(1) // Color plane count.
  sink.writeShortLe(bytesPerPixel * Byte.SIZE_BITS)
  sink.writeIntLe(0) // No compression.
  sink.writeIntLe(16) // Size of bitmap data including padding.
  sink.writeIntLe(2835) // Horizontal print resolution in pixels/meter. (72 dpi).
  sink.writeIntLe(2835) // Vertical print resolution in pixels/meter. (72 dpi).
  sink.writeIntLe(0) // Palette color count.
  sink.writeIntLe(0) // 0 important colors.

  // Pixel data.
  for (y in height - 1 downTo 0) {
    for (x in 0 until width) {
      sink.writeByte(bitmap.blue(x, y))
      sink.writeByte(bitmap.green(x, y))
      sink.writeByte(bitmap.red(x, y))
    }

    // Padding for 4-byte alignment.
    for (p in rowByteCountWithoutPadding until rowByteCount) {
      sink.writeByte(0)
    }
  }
}
```</p>
<p>The trickiest part of this program is the format’s required padding. The BMP
format expects each row to begin on a 4-byte boundary so it is necessary to add
zeros to maintain the alignment.</p>
<p>Encoding other binary formats is usually quite similar. Some tips:</p>
<ul>
<li>Write tests with golden values! Confirming that your program emits the
   expected result can make debugging easier.</li>
<li>Use <code>Utf8.size()</code> to compute the number of bytes of an encoded string. This
   is essential for length-prefixed formats.</li>
<li>Use <code>Float.floatToIntBits()</code> and <code>Double.doubleToLongBits()</code> to encode
   floating point values.</li>
</ul>
<h3 id="communicate-on-a-socket-javakotlin">Communicate on a Socket (<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/java/okio/samples/SocksProxyServer.java">Java</a>/<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/kotlin/okio/samples/SocksProxyServer.kt">Kotlin</a>)<a class="headerlink" href="#communicate-on-a-socket-javakotlin" title="Permanent link">&para;</a></h3>
<p>Sending and receiving data over the network is a bit like writing and reading
files. We use <code>BufferedSink</code> to encode output and <code>BufferedSource</code> to decode
input. Like files, network protocols can be text, binary, or a mix of both. But
there are also some substantial differences between the network and the
filesystem.</p>
<p>With a file you’re either reading or writing but with the network you can do
both! Some protocols handle this by taking turns: write a request, read a
response, repeat. You can implement this kind of protocol with a single thread.
In other protocols you may read and write simultaneously. Typically you’ll want
one dedicated thread for reading. For writing you can use either a dedicated
thread or use <code>synchronized</code> so that multiple threads can share a sink. Okio’s
streams are not safe for concurrent use.</p>
<p>Sinks buffer outbound data to minimize I/O operations. This is efficient but it
means you must manually call <code>flush()</code> to transmit data. Typically
message-oriented protocols flush after each message. Note that Okio will
automatically flush when the buffered data exceeds some threshold. This is
intended to save memory and you shouldn’t rely on it for interactive protocols.</p>
<p>Okio builds on <code>java.io.Socket</code> for connectivity. Create your socket as a server
or as a client, then use <code>Okio.source(Socket)</code> to read and <code>Okio.sink(Socket)</code>
to write. These APIs also work with <code>SSLSocket</code>. You should use SSL unless you
have a very good reason not to!</p>
<p>Cancel a socket from any thread by calling <code>Socket.close()</code>; this will cause its
sources and sinks to immediately fail with an <code>IOException</code>. You can also
configure timeouts for all socket operations. You don’t need a reference to the
socket to adjust timeouts: <code>Source</code> and <code>Sink</code> expose timeouts directly. This
API works even if the streams are decorated.</p>
<p>As a complete example of networking with Okio we wrote a <a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/java/okio/samples/SocksProxyServer.java">basic SOCKS
proxy</a> server. Some highlights:</p>
<p>```Java tab=
Socket fromSocket = &hellip;
BufferedSource fromSource = Okio.buffer(Okio.source(fromSocket));
BufferedSink fromSink = Okio.buffer(Okio.sink(fromSocket));
<div class="highlight"><pre><span></span><code>```Kotlin tab=
val fromSocket: Socket = ...
val fromSource = fromSocket.source().buffer()
val fromSink = fromSocket.sink().buffer()
</code></pre></div></p>
<p>Creating sources and sinks for sockets is the same as creating them for files.
Once you create a <code>Source</code> or <code>Sink</code> for a socket you must not use its
<code>InputStream</code> or <code>OutputStream</code>, respectively.</p>
<p>```Java tab=
Buffer buffer = new Buffer();
for (long byteCount; (byteCount = source.read(buffer, 8192L)) != -1; ) {
  sink.write(buffer, byteCount);
  sink.flush();
}
<div class="highlight"><pre><span></span><code>```Kotlin tab=
val buffer = Buffer()
var byteCount: Long
while (source.read(buffer, 8192L).also { byteCount = it } != -1L) {
  sink.write(buffer, byteCount)
  sink.flush()
}
</code></pre></div></p>
<p>The above loop copies data from the source to the sink, flushing after each
read. If we didn’t need the flushing we could replace this loop with a single
call to <code>BufferedSink.writeAll(Source)</code>.</p>
<p>The <code>8192</code> argument to <code>read()</code> is the maximum number of bytes to read before
returning. We could have passed any value here, but we like 8 KiB because that’s
the largest value Okio can do in a single system call. Most of the time
application code doesn’t need to deal with such limits!</p>
<p>```Java tab=
int addressType = fromSource.readByte() &amp; 0xff;
int port = fromSource.readShort() &amp; 0xffff;
<div class="highlight"><pre><span></span><code>```Kotlin tab=
val addressType = fromSource.readByte().toInt() and 0xff
val port = fromSource.readShort().toInt() and 0xffff
</code></pre></div></p>
<p>Okio uses signed types like <code>byte</code> and <code>short</code>, but often protocols want
unsigned values. The bitwise <code>&amp;</code> operator is Java’s preferred idiom to convert
a signed value into an unsigned value. Here’s a cheat sheet for bytes, shorts,
and ints:</p>
<table>
<thead>
<tr>
<th align="left">Type</th>
<th align="center">Signed Range</th>
<th align="left">Unsigned Range</th>
<th align="left">Signed to Unsigned</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">byte</td>
<td align="center">-128..127</td>
<td align="left">0..255</td>
<td align="left"><code>int u = s &amp; 0xff;</code></td>
</tr>
<tr>
<td align="left">short</td>
<td align="center">-32,768..32,767</td>
<td align="left">0..65,535</td>
<td align="left"><code>int u = s &amp; 0xffff;</code></td>
</tr>
<tr>
<td align="left">int</td>
<td align="center">-2,147,483,648..2,147,483,647</td>
<td align="left">0..4,294,967,295</td>
<td align="left"><code>long u = s &amp; 0xffffffffL;</code></td>
</tr>
</tbody>
</table>
<p>Java has no primitive type that can represent unsigned longs.</p>
<h3 id="hashing-javakotlin">Hashing (<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/java/okio/samples/Hashing.java">Java</a>/<a href="https://github.com/square/okio/blob/master/samples/src/jvmMain/kotlin/okio/samples/Hashing.kt">Kotlin</a>)<a class="headerlink" href="#hashing-javakotlin" title="Permanent link">&para;</a></h3>
<p>We’re bombarded by hashing in our lives as Java programmers. Early on we&rsquo;re introduced to the
<code>hashCode()</code> method, something we know we need to override otherwise unforeseen bad things happen.
Later we’re shown <code>LinkedHashMap</code> and its friends. These build on that <code>hashCode()</code> method to
organize data for fast retrieval.</p>
<p>Elsewhere we have cryptographic hash functions. These get used all over the place. HTTPS
certificates, Git commits, BitTorrent integrity checking, and Blockchain blocks all use
cryptographic hashes. Good use of hashes can improve the performance, privacy, security, and
simplicity of an application.</p>
<p>Each cryptographic hash function accepts a variable-length stream of input bytes and produces a
fixed-length byte string value called the “hash”. Hash functions have these important qualities:</p>
<ul>
<li>Deterministic: each input always produces the same output.</li>
<li>Uniform: each output byte string is equally likely. It is very difficult to find or create pairs
   of different inputs that yield the same output. This is called a “collision”.</li>
<li>Non-reversible: knowing an output doesn&rsquo;t help you to find the input. Note that if you know some
   possible inputs you can hash them to see if their hashes match.</li>
<li>Well-known: the hash is implemented everywhere and rigorously understood.</li>
</ul>
<p>Good hash functions are very cheap to compute (dozens of microseconds) and expensive to reverse
(quintillions of millenia). Steady advances in computing and mathematics have caused once-great hash
functions to become inexpensive to reverse. When choosing a hash function, beware that not all are
created equal! Okio supports these well-known cryptographic hash functions:</p>
<ul>
<li><strong>MD5</strong>: a 128-bit (16 byte) cryptographic hash. It is both insecure and obsolete because it is
   inexpensive to reverse! This hash is offered because it is popular and convenient for use in
   legacy systems that are not security-sensitive.</li>
<li><strong>SHA-1</strong>: a 160-bit (20 byte) cryptographic hash. It was recently demonstrated that it is
   feasible to create SHA-1 collisions. Consider upgrading from SHA-1 to SHA-256.</li>
<li><strong>SHA-256</strong>: a 256-bit (32 byte) cryptographic hash. SHA-256 is widely understood and expensive
   to reverse. This is the hash most systems should use.</li>
<li><strong>SHA-512</strong>: a 512-bit (64 byte) cryptographic hash. It is expensive to reverse.</li>
</ul>
<p>Each hash creates a <code>ByteString</code> of the specified length. Use <code>hex()</code> to get the conventional
human-readable form. Or leave it as a <code>ByteString</code> because that’s a convenient model type!</p>
<p>Okio can produce cryptographic hashes from byte strings:</p>
<p>```Java tab=
ByteString byteString = readByteString(new File(&ldquo;README.md&rdquo;));
System.out.println(&rdquo;   md5: &rdquo; + byteString.md5().hex());
System.out.println(&rdquo;  sha1: &rdquo; + byteString.sha1().hex());
System.out.println(&ldquo;sha256: &rdquo; + byteString.sha256().hex());
System.out.println(&ldquo;sha512: &rdquo; + byteString.sha512().hex());
<div class="highlight"><pre><span></span><code>```Kotlin tab=
val byteString = readByteString(File(&quot;README.md&quot;))
println(&quot;       md5: &quot; + byteString.md5().hex())
println(&quot;      sha1: &quot; + byteString.sha1().hex())
println(&quot;    sha256: &quot; + byteString.sha256().hex())
println(&quot;    sha512: &quot; + byteString.sha512().hex())
</code></pre></div></p>
<p>From buffers:</p>
<p>```Java tab=
Buffer buffer = readBuffer(new File(&ldquo;README.md&rdquo;));
System.out.println(&rdquo;   md5: &rdquo; + buffer.md5().hex());
System.out.println(&rdquo;  sha1: &rdquo; + buffer.sha1().hex());
System.out.println(&ldquo;sha256: &rdquo; + buffer.sha256().hex());
System.out.println(&ldquo;sha512: &rdquo; + buffer.sha512().hex());
<div class="highlight"><pre><span></span><code>```Kotlin tab=
val buffer = readBuffer(File(&quot;README.md&quot;))
println(&quot;       md5: &quot; + buffer.md5().hex())
println(&quot;      sha1: &quot; + buffer.sha1().hex())
println(&quot;    sha256: &quot; + buffer.sha256().hex())
println(&quot;    sha512: &quot; + buffer.sha512().hex())
</code></pre></div></p>
<p>While streaming from a source:</p>
<p>```Java tab=
try (HashingSink hashingSink = HashingSink.sha256(Okio.blackhole());
     BufferedSource source = Okio.buffer(Okio.source(file))) {
  source.readAll(hashingSink);
  System.out.println(&ldquo;sha256: &rdquo; + hashingSink.hash().hex());
}
<div class="highlight"><pre><span></span><code>```Kotlin tab=
sha256(blackholeSink()).use { hashingSink -&gt;
  file.source().buffer().use { source -&gt;
    source.readAll(hashingSink)
    println(&quot;    sha256: &quot; + hashingSink.hash.hex())
  }
}
</code></pre></div></p>
<p>While streaming to a sink:</p>
<p>```Java tab=
try (HashingSink hashingSink = HashingSink.sha256(Okio.blackhole());
     BufferedSink sink = Okio.buffer(hashingSink);
     Source source = Okio.source(file)) {
  sink.writeAll(source);
  sink.close(); // Emit anything buffered.
  System.out.println(&ldquo;sha256: &rdquo; + hashingSink.hash().hex());
}
<div class="highlight"><pre><span></span><code>```Kotlin tab=
sha256(blackholeSink()).use { hashingSink -&gt;
  hashingSink.buffer().use { sink -&gt;
    file.source().use { source -&gt;
      sink.writeAll(source)
      sink.close() // Emit anything buffered.
      println(&quot;    sha256: &quot; + hashingSink.hash.hex())
    }
  }
}
</code></pre></div></p>
<p>Okio also supports HMAC (Hash Message Authentication Code) which combines a secret and a hash.
Applications use HMAC for data integrity and authentication.</p>
<p>```Java tab=
ByteString secret = ByteString.decodeHex(&ldquo;7065616e7574627574746572&rdquo;);
System.out.println(&ldquo;hmacSha256: &rdquo; + byteString.hmacSha256(secret).hex());
<div class="highlight"><pre><span></span><code>```Kotlin tab=
val secret = &quot;7065616e7574627574746572&quot;.decodeHex()
println(&quot;hmacSha256: &quot; + byteString.hmacSha256(secret).hex())
</code></pre></div></p>
<p>As with hashing, you can generate an HMAC from a <code>ByteString</code>, <code>Buffer</code>, <code>HashingSource</code>, and
<code>HashingSink</code>. Note that Okio doesn’t implement HMAC for MD5. Okio uses Java’s
<code>java.security.MessageDigest</code> for cryptographic hashes and <code>javax.crypto.Mac</code> for HMAC.</p>
<h2 id="releases">Releases<a class="headerlink" href="#releases" title="Permanent link">&para;</a></h2>
<p>Our <a href="http://square.github.io/okio/changelog/">change log</a> has release history.</p>
<div class="highlight"><pre><span></span><code><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;com.squareup.okio:okio:2.7.0&quot;</span><span class="p">)</span>
</code></pre></div>

<details>
   <summary>Snapshot builds are also available</summary>

<div class="highlight"><pre><span></span><code><span class="n">repositories</span> <span class="p">{</span>
    <span class="n">maven</span> <span class="p">{</span>
        <span class="n">url</span> <span class="p">=</span> <span class="n">uri</span><span class="p">(</span><span class="s">&quot;https://oss.sonatype.org/content/repositories/snapshots/&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">dependencies</span> <span class="p">{</span>
   <span class="n">implementation</span><span class="p">(</span><span class="s">&quot;com.squareup.okio:okio:2.7.0&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h2 id="r8-proguard">R8 / ProGuard<a class="headerlink" href="#r8-proguard" title="Permanent link">&para;</a></h2>
<p>If you are using R8 or ProGuard add the options from <a href="https://github.com/square/okio/blob/master/okio/src/jvmMain/resources/META-INF/proguard/okio.pro">this file</a>.</p>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code>Copyright 2013 Square, Inc.

Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
        
          <a href="2.x/okio/okio/" title="2.x API" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                2.x API
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 Square, Inc.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.d1f5a259.min.js"></script>
      <script src="assets/javascripts/bundle.d5fec882.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: [],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.fae956e7.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>